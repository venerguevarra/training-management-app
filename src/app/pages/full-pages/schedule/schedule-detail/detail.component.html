

<div class="card">

  <div class="card-header" style="background-color: #ECEFF1;">
    <h3 *ngIf="!newForm">{{title}} Details</h3>
    <h3 *ngIf="newForm">New {{title}}</h3>
  </div>

  <div class="card-body">
    <!-- REVENUE  CARDS -->

    <div *ngIf="editForm" class="row justify-content-md-center">
      <div class="card col-md-6 bg-warning white mr-1">
        <div class="card-content">
          <div class="px-3 py-3">
            <div class="media">
              <div class="media-body white text-left">
                <h3 class="mb-1 white" style="color: white;">{{revenueModel.scheduleCost || 0 | currency: 'PHP '}} </h3>
                <span class="white">Total Cost</span>
              </div>
              <div class="media-right align-self-center">
                <i class="icon-pie-chart font-large-2 float-right"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="editForm" class="row justify-content-md-center">
      <div class="card col-md-3 bg-success white mr-1">
        <div class="card-content">
          <div class="px-3 py-3">
            <div class="media">
              <div class="media-body white text-left">
                <h2 class="mb-1 white" style="color: white;">{{revenueModel.profitMargin || 0 }} %</h2>
                <span class="white">Target Profit Margin</span>
                <br/><br/>
                <h3 class="mb-1 white" style="color: white;">{{revenueModel.grossRevenue || 0 | currency: 'PHP '}}</h3>
                <span class="white">Target Gross Revenue</span>
                <br/><br/>
                <h3 class="mb-1 white" style="color: white;">{{revenueModel.netRevenue || 0 | currency: 'PHP '}}</h3>
                <span class="white">Target Net Revenue</span>
              </div>
              <div class="media-right align-self-center">
                <i class="icon-pie-chart font-large-2 float-right"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card col-md-3 bg-danger white mr-1">
        <div class="card-content">
          <div class="px-3 py-3">
            <div class="media">
              <div class="media-body white text-left">
                <h2 class="mb-1 white" style="color: white;">{{revenueModel.actualProfitMargin || 0 }} %</h2>
                <span class="white">Actual Profit Margin</span>
                <br/><br/>
                <h3 class="mb-1 white" style="color: white;">{{revenueModel.actualGrossRevenue || 0 | currency: 'PHP '}}</h3>
                <span class="white">Actual Gross Revenue</span>
                <br/><br/>
                <h3 class="mb-1 white" style="color: white;">{{revenueModel.actualNetRevenue || 0 | currency: 'PHP '}}</h3>
                <span class="white">Actual Net Revenue</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- end -->

    <div class="row text-left justify-content-md-center striped-rows">
      <!-- view form start -->
      <div *ngIf="newForm == false && viewForm == true" class="col-md-6">
        <form class="form form-horizontal striped-rows">
        <br/>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="name">Course</label>
              <div class="col-md-9">
                <app-course-detail [id]="f.courseId.value"></app-course-detail>
              </div>
            </div>
        </div>

        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Venue</label>
            <div class="col-md-9">
              <app-venue-detail [id]="f.venueId.value"></app-venue-detail>
            </div>
          </div>
        </div>

        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Facilitator</label>
            <div class="col-md-9">
              <app-facilitator-detail [id]="f.facilitatorId.value" [showEmail]="true" [showMobileNumber]="true"></app-facilitator-detail>
            </div>
          </div>
        </div>

        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Status</label>
            <div class="col-md-9">
              <span *ngIf="f.status.value == 'SCHEDULE_WAITING'">AWAITING CONFIRMATION</span>
              <span *ngIf="f.status.value == 'SCHEDULE_CONFIRMED'">CONFIRMED</span>
              <span *ngIf="f.status.value == 'SCHEDULE_CANCELLED'">CANCELLED</span>
              <span *ngIf="f.status.value == 'SCHEDULE_DELIVERED'">DELIVERED</span>
            </div>
          </div>
        </div>

        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Total Cost</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.scheduleCost">{{revenueModel.scheduleCost | currency: 'PHP '}}</span>
            </div>
          </div>
        </div>

        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Actual Gross Revenue</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.actualGrossRevenue">{{revenueModel.actualGrossRevenue || 0 | currency: 'PHP '}}</span>
            </div>
          </div>
        </div>
        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Gross Revenue</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.grossRevenue">{{revenueModel.grossRevenue || 0 | currency: 'PHP '}}</span>
            </div>
          </div>
        </div>


        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Actual Net Revenue</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.actualNetRevenue">{{revenueModel.actualNetRevenue || 0 | currency: 'PHP '}}</span>
            </div>
          </div>
        </div>
        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Net Revenue</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.netRevenue">{{revenueModel.netRevenue || 0 | currency: 'PHP '}}</span>
            </div>
          </div>
        </div>


        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Actual Profit Margin</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.actualProfitMargin">{{revenueModel.actualProfitMargin || 0 }} %</span>
            </div>
          </div>
        </div>

        <!-- projected -->



        <div class="form-body">
          <div class="form-group row">
            <label class="col-md-3 label-control" for="name">Profit Margin</label>
            <div class="col-md-9">
              <span *ngIf="revenueModel.profitMargin">{{revenueModel.profitMargin || 0 }} %</span>
            </div>
          </div>
        </div>



      <div class="form-body">
        <div class="form-group row">
          <label class="col-md-3 label-control" for="startDate">Start Date</label>
          <div class="col-md-9">
            <span *ngIf="f.startDate">{{f.startDate.value | date: 'MMM d, y'}}</span>
          </div>
        </div>
      </div>
      <div class="form-body">
        <div class="form-group row">
          <label class="col-md-3 label-control" for="endDate">End Date</label>
          <div class="col-md-9">
            <span *ngIf="f.endDate">{{f.endDate.value | date: 'MMM d, y'}}</span>
          </div>
        </div>
      </div>
      <div class="form-body">
        <div class="form-group row">
          <label class="col-md-3 label-control" for="startTime">Start Time</label>
          <div class="col-md-9">
            <span *ngIf="f.startTime">{{formattedStartTime}}</span>
          </div>
        </div>
      </div>
      <div class="form-body">
        <div class="form-group row">
          <label class="col-md-3 label-control" for="endDate">End Time</label>
          <div class="col-md-9">
            <span *ngIf="f.endTime">{{formattedEndTime}}</span>
          </div>
        </div>
      </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="createdDate">Date Created</label>
              <div class="col-md-9">
                <span *ngIf="f.createdDate">{{f.createdDate.value | date: 'MMM d, y h:mm:ss a'}}</span>
              </div>
            </div>
        </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="createdBy">Created By</label>
              <div class="col-md-9">
                {{createdBy}}
              </div>
            </div>
        </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="modifiedDate">Last Modified Date</label>
              <div class="col-md-9">
                <span *ngIf="f.modifiedDate">{{f.modifiedDate.value | date: 'MMM d, y h:mm:ss a'}}</span>
              </div>
            </div>
        </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="modifiedBy">Last Modified By</label>
              <div class="col-md-9">
                {{modifiedBy}}
              </div>
            </div>
        </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control" for="status">Status</label>
              <div class="col-md-9">

              </div>
            </div>
        </div>
        <div class="form-body">
            <div class="form-group row">
              <label class="col-md-3 label-control">&nbsp;</label>
              <div class="col-md-9">
                <button type="button" class="btn btn-raised btn-success mr-2" (click)="showEditForm()">
                  <i class="fa fa-check-square-o"></i> Edit
                </button>
                <button type="button" class="btn btn-danger btn-raised" (click)="cancel()">
                  <i class="ft-x"></i> Cancel
                </button>
              </div>
            </div>
        </div>
        </form>
      </div>
      <!-- view form end -->

      <!-- new form and edit form start -->
      <div *ngIf="newForm == true || editForm == true" class="col-md-6">
        <div class="card">
          <div class="card-content">
            <div class="px-3">
              <form class="form form-horizontal" [formGroup]="currentForm">

                <input *ngIf="editForm" type="hidden" formControlName="id">

                <div class="form-body">

                  <div class="form-group row">
                    <label class="col-md-3 label-control">&nbsp;</label>
                    <div class="col-md-9">
                      Fields with <span class="px-required">*</span> are required.
                    </div>
                  </div>


                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Course<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input type="hidden" formControlName="courseId">
                      <app-course-select (selectedIdEmitter)="onCourseSelected($event)" [isInvalid]="isCourseIdInvalid" [selectedCourse]="selectedCourse"></app-course-select>
                      <small *ngIf="isCourseIdInvalid" class="form-text text-muted danger">Course inquired required</small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Course Fee<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input  formControlName="courseFee"  type="number" id="courseFee" class="form-control" name="courseFee"  [ngClass]="{ 'is-invalid': isInvalid(f.courseFee)}">
                      <small *ngIf="(f.courseFee.dirty || f.courseFee.touched || submitted) && f.courseFee.invalid && f.courseFee.errors.required" class="form-text text-muted danger">
                        Course fee required
                      </small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Number of Days<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input  formControlName="numberOfDays"  type="number" id="numberOfDays" class="form-control" name="numberOfDays"  [ngClass]="{ 'is-invalid': isInvalid(f.numberOfDays)}">
                      <small *ngIf="(f.numberOfDays.dirty || f.numberOfDays.touched || submitted) && f.numberOfDays.invalid && f.numberOfDays.errors.required" class="form-text text-muted danger">
                        Number of days required
                      </small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Venue<span
                        class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input type="hidden" formControlName="venueId">
                      <app-venue-select (selectedIdEmitter)="onVenueSelected($event)" [isInvalid]="isCourseIdInvalid" [selectedVenue]="selectedVenue"></app-venue-select>
                      <small *ngIf="isVenueIdInvalid" class="form-text text-muted danger">Venue required</small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Facilitator<span
                        class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input type="hidden" formControlName="facilitatorId">
                      <app-facilitator-select (selectedIdEmitter)="onFacilitatorSelected($event)" [isInvalid]="isFacilitatorIdInvalid" [selectedFacilitator]="selectedFacilitator"></app-facilitator-select>
                      <small *ngIf="isFacilitatorIdInvalid" class="form-text text-muted danger">Facilitator required</small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Facilitator Rate<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input  formControlName="facilitatorDailyRate"  type="number" id="facilitatorDailyRate" class="form-control" name="facilitatorDailyRate"  [ngClass]="{ 'is-invalid': isInvalid(f.facilitatorDailyRate)}">
                      <small *ngIf="(f.facilitatorDailyRate.dirty || f.facilitatorDailyRate.touched || submitted) && f.facilitatorDailyRate.invalid && f.facilitatorDailyRate.errors.required" class="form-text text-muted danger">
                        Facilitator daily rate required
                      </small>
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Minimum # of Participants<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <input formControlName="registeredParticipants" type="number" id="registeredParticipants" class="form-control" name="registeredParticipants" [ngClass]="{ 'is-invalid': isInvalid(f.registeredParticipants)}" placeholder="e.g. 10">
                      <small
                        *ngIf="(f.registeredParticipants.dirty || f.registeredParticipants.touched || submitted) && f.registeredParticipants.invalid && f.registeredParticipants.errors.required"
                        class="form-text text-muted danger">
                        No. of participants required
                      </small>
                    </div>
                  </div>

                  <div  class="form-group row">
                    <label class="col-md-3 label-control" for="name">Status<span class="px-required">*</span></label>
                    <div *ngIf="editForm" class="col-md-9">
                      <select *ngIf="editForm" formControlName="status" class="custom-select" [ngClass]="{ 'is-invalid': isInvalid(f.status)}">
                        <option value="SCHEDULE_WAITING">AWAITING CONFIRMATION</option>
                        <option value="SCHEDULE_CONFIRMED">CONFIRMED</option>
                        <option value="SCHEDULE_CANCELLED">CANCELLED</option>
                        <option value="COURSE_DELIVERED">DELIVERED</option>
                      </select>
                      <small
                        *ngIf="editForm && (f.status.dirty || f.status.touched || submitted) && f.status.invalid && f.status.errors.required"
                        class="form-text text-muted danger">
                        Status required
                      </small>
                    </div>
                    <div *ngIf="newForm" class="col-md-9">
                      <input *ngIf="newForm" type="hidden" formControlName="status">
                      AWAITING CONFIRMATION
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Inclusive Dates<span class="px-required">*</span></label>
                    <div class="col-md-9">

                      <ngb-datepicker #dp (select)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="t" outsideDays="hidden">
                      </ngb-datepicker>

                      <ng-template #t let-date let-focused="focused">
                        <span class="custom-day"
                              [class.focused]="focused"
                              [class.range]="isRange(date)"
                              [class.faded]="isHovered(date) || isInside(date)"
                              (mouseenter)="hoveredDate = date"
                              (mouseleave)="hoveredDate = null">
                          {{ date.day }}
                        </span>
                      </ng-template>

                      <small *ngIf="isTrainingDateInvalid && submitted" class="form-text text-muted danger">Training date required</small>
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">Start Time<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <ngb-timepicker formControlName="startTime" [meridian]="meridian" [minuteStep]="30"></ngb-timepicker>
                      <small *ngIf="isStartTimeValid && submitted" class="form-text text-muted danger">Start time required</small>
                    </div>
                  </div>
                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="name">End Time<span class="px-required">*</span></label>
                    <div class="col-md-9">
                      <ngb-timepicker formControlName="endTime" [meridian]="meridian" [minuteStep]="30"></ngb-timepicker>
                      <small *ngIf="isEndTimeValid && submitted" class="form-text text-muted danger">End time required</small>
                    </div>
                  </div>

                  <input type="hidden" formControlName="status">

                  <div class="form-group row">
                    <label class="col-md-3 label-control" for="eventRegInput4">&nbsp;</label>
                    <div class="col-md-9">
                      <button *ngIf="editForm" type="button" class="btn btn-raised btn-success mr-2" (click)="update()">
                        <i class="fa fa-check-square-o"></i> Save Changes
                      </button>
                      <button *ngIf="newForm" type="button" class="btn btn-raised btn-success mr-2" (click)="saveNew()">
                        <i class="fa fa-check-square-o"></i> Save
                      </button>
                      <button type="button" class="btn btn-danger btn-raised" (click)="cancel()">
                        <i class="ft-x"></i> Cancel
                      </button>
                    </div>
                  </div>

                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- new form and edit form end -->
    </div>
  </div>

</div>